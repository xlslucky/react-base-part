{"version":3,"file":"index.js","sources":["../../../src/hooks/useSlider/index.ts"],"sourcesContent":["import React from 'react'\nimport { UseSliderProps, UseSliderCommonProps } from './useSlider.types'\nimport { sliderCalc } from './utils'\nimport { isEmpty } from '../../utils'\n\nfunction useSliderCommon({ railRef, step, min, max }: UseSliderCommonProps) {\n  const [distanceWidth, setDistanceWidth] = React.useState(0)\n\n  React.useEffect(() => {\n    const railDom = railRef.current\n    if (railDom) {\n      const { width } = railDom.getBoundingClientRect()\n      setDistanceWidth(Number(width / ((max - min) / step)))\n    }\n  }, [max, min, railRef, step])\n\n  return { distanceWidth }\n}\n\nfunction useSlider({\n  railRef,\n  handleRef,\n  max,\n  step,\n  min,\n  smooth,\n  value,\n  onSuccess,\n}: UseSliderProps) {\n  const [left, setLeft] = React.useState(0)\n  const [nextValue, setNextValue] = React.useState(0)\n  const { distanceWidth } = useSliderCommon({ railRef, step, min, max })\n\n  React.useEffect(() => {\n    // value发生改变就按照value值设置\n    if (!isEmpty(value)) {\n      setNextValue(value as number)\n      setLeft(((value as number) / step) * distanceWidth)\n    }\n  }, [distanceWidth, step, value])\n\n  function onMouseDown(downEvent: React.MouseEvent<HTMLElement, MouseEvent>) {\n    if (!handleRef.current || !railRef.current) {\n      return\n    }\n    const handleDom = handleRef.current\n    const railDom = railRef.current\n    const { x: handleX, width: handleWidth } = handleDom.getBoundingClientRect()\n    const excursion = downEvent.clientX - handleX\n    document.onmousemove = (moveEvent: MouseEvent) => {\n      const { clientX } = moveEvent\n      const { value, moveLeft } = sliderCalc({\n        railDom,\n        clientX,\n        excursion,\n        handleWidth,\n        step,\n        smooth,\n        distanceWidth,\n      })\n      setNextValue(value)\n      setLeft(moveLeft)\n      document.onmouseup = () => {\n        document.onmousemove = null\n        document.onmouseup = null\n        onSuccess(value)\n      }\n    }\n  }\n\n  function onTouchStart(startEvent: React.TouchEvent<HTMLElement>) {\n    if (!handleRef.current || !railRef.current) {\n      return\n    }\n    const handleDom = handleRef.current\n    const railDom = railRef.current\n    const { x: handleX, width: handleWidth } = handleDom.getBoundingClientRect()\n    const excursion = startEvent.touches[0].clientX - handleX\n    document.ontouchmove = (moveEvent: TouchEvent) => {\n      const { clientX } = moveEvent.touches[0]\n      const { value, moveLeft } = sliderCalc({\n        railDom,\n        clientX,\n        excursion,\n        handleWidth,\n        step,\n        smooth,\n        distanceWidth,\n      })\n      setNextValue(value)\n      setLeft(moveLeft)\n      document.ontouchend = () => {\n        document.ontouchmove = null\n        document.ontouchend = null\n        onSuccess(value)\n      }\n    }\n  }\n\n  function onClick(event: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n    if (!handleRef.current || !railRef.current) {\n      return\n    }\n    const handleDom = handleRef.current\n    const railDom = railRef.current\n    const { width: handleWidth } = handleDom.getBoundingClientRect()\n    const { value, moveLeft } = sliderCalc({\n      railDom,\n      clientX: event.clientX,\n      excursion: handleWidth / 2,\n      handleWidth,\n      step,\n      smooth,\n      distanceWidth,\n    })\n    setNextValue(value)\n    setLeft(moveLeft)\n  }\n\n  return {\n    nextValue,\n    left,\n    onMouseDown,\n    onTouchStart,\n    onClick,\n  }\n}\n\nexport default useSlider\n"],"names":["React","isEmpty","sliderCalc"],"mappings":"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"}