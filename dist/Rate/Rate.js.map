{"version":3,"file":"Rate.js","sources":["../../src/Rate/Rate.tsx"],"sourcesContent":["import React from 'react'\nimport classnames from 'classnames'\n\nimport { RateProps } from './Rate.types'\n\nimport './Rate.scss'\nimport { PREFIX_CLASS } from '../constants'\n\nconst Rate: React.FC<RateProps> = ({\n  allowHalf,\n  character = '❤',\n  activeCharacter,\n  count = 5,\n  value,\n  onChange,\n  className,\n  style,\n  prefixCls = PREFIX_CLASS,\n}) => {\n  const prefixClass = `${prefixCls}-rate`\n  const [innerValue, setInnerValue] = React.useState<undefined | number>()\n  const [hoverValue, setHoverValue] = React.useState<undefined | number>()\n\n  React.useEffect(() => {\n    setInnerValue(value)\n  }, [value])\n\n  const onClick = React.useCallback(\n    (itemValue: number) => {\n      setInnerValue(itemValue)\n      if (typeof onChange === 'function') {\n        onChange(itemValue)\n      }\n    },\n    [onChange]\n  )\n\n  const onMouseEnter = (itemValue: number) => () => {\n    setHoverValue(itemValue)\n  }\n\n  function onMouseLeave() {\n    setHoverValue(undefined)\n  }\n\n  const isActive = React.useCallback(\n    (val: number) => {\n      const v = hoverValue || innerValue\n      return Boolean(v && v >= val)\n    },\n    [hoverValue, innerValue]\n  )\n\n  const renderStar = React.useCallback(\n    (index: number, itemValue: number) => {\n      if (isActive(itemValue) && activeCharacter) {\n        return typeof activeCharacter === 'function'\n          ? activeCharacter(index)\n          : activeCharacter\n      }\n      return typeof character === 'function' ? character(index) : character\n    },\n    [activeCharacter, character, isActive]\n  )\n\n  const renderItem = React.useCallback(\n    index => {\n      const halfValue = index + 0.5\n      const fullValue = index + 1\n      return (\n        <>\n          {allowHalf ? (\n            <div\n              className={`${prefixClass}-star-first`}\n              onMouseEnter={onMouseEnter(halfValue)}\n              onClick={() => onClick(halfValue)}\n            >\n              {renderStar(index, halfValue)}\n            </div>\n          ) : null}\n          <div\n            className={`${prefixClass}-star-second`}\n            onMouseEnter={onMouseEnter(fullValue)}\n            onClick={() => onClick(fullValue)}\n          >\n            {renderStar(index, fullValue)}\n          </div>\n        </>\n      )\n    },\n    [allowHalf, onClick, prefixClass, renderStar]\n  )\n\n  const getStarClassName = React.useCallback(\n    (index: number) => {\n      const v = hoverValue || innerValue\n      if (!v) {\n        return\n      }\n      if (v >= index + 1) {\n        return `${prefixClass}-star-full`\n      }\n      if (v > index && v < index + 1) {\n        return `${prefixClass}-star-half`\n      }\n    },\n    [hoverValue, innerValue, prefixClass]\n  )\n\n  return (\n    <div\n      style={style}\n      onMouseLeave={onMouseLeave}\n      className={classnames(prefixClass, className)}\n    >\n      {new Array(count).fill(undefined).map((_, index) => {\n        return (\n          <div\n            key={index}\n            className={classnames(\n              `${prefixClass}-star`,\n              getStarClassName(index)\n            )}\n          >\n            {renderItem(index)}\n          </div>\n        )\n      })}\n    </div>\n  )\n}\n\nexport default Rate\n"],"names":["PREFIX_CLASS","React","_jsxs","_jsx"],"mappings":"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"}